library(ggplot2)
xl <- readxl::read_excel('./FR_Expt_13Jan2020_032424_1954463.xlsx')
library(dplyr)
xl %>%
mutate(`FY Total Cost` = if_else(is.na(`FY Total Cost`), `FY Total Cost  (Sub Projects)`, `FY Total Cost`)) %>%
group_by(Agency, FY) %>%
summarize(total = sum(`FY Total Cost`)) %>%
ggplot(aes(FY, total)) +
geom_line() +
facet_wrap(~ Agency)
xl %>%
mutate(`FY Total Cost` = if_else(is.na(`FY Total Cost`), `FY Total Cost  (Sub Projects)`, `FY Total Cost`)) %>%
group_by(Agency, FY) %>%
summarize(total = sum(`FY Total Cost`)) %>%
ggplot(aes(FY, total)) +
geom_line() +
facet_wrap(~ Agency, scales = "free_y")
xl %>% filter(Agency == "NSF") %>% View()
xl %>% count(Agency, `Organization Name`)
xl %>%
count(Agency, FY) %>%
ggplot(aes(FY, n)) +
geom_line() +
facet_wrap(~ Agency, scales = "free_y")
xl %>% filter(Agency == "NSF") %>% View()
data <- readxl::read_excel("../Award-CIP4-Sex-RaceEth.xlsx") %>%
select(-`[Institution Name]`) %>%
rename(
CRED = `[Award Level Code]`,
CIP4 = `[CIP Code and Description (4 digit)]`,
race_eth = `[Race and Ethnicity]`,
sex = `[Sex]`
) %>%
gather(year, count, `2017`:`1997`) %>%
mutate(
count = as.numeric(count),
year = as.numeric(year)
)
xl <- readxl::read_excel('./FR_Expt_14Jan2020_055938_6430774.xlsx')
# By total funding
xl %>%
mutate(`FY Total Cost` = if_else(is.na(`FY Total Cost`), `FY Total Cost  (Sub Projects)`, `FY Total Cost`)) %>%
group_by(Agency, FY) %>%
summarize(total = sum(`FY Total Cost`)) %>%
ggplot(aes(FY, total)) +
geom_line() +
facet_wrap(~ Agency, scales = "free_y")
View(xl)
# By number of projects
xl %>%
count(Agency, FY) %>%
ggplot(aes(FY, n)) +
geom_line() +
facet_wrap(~ Agency, scales = "free_y")
xl %>% count(`CFDA Code`)
xl %>% count(`CFDA Code`) %>% arrange(-n)
xl %>% count(`CFDA Code`) %>% arrange(-n) %>% View()
# By total funding
xl %>%
mutate(`FY Total Cost` = if_else(is.na(`FY Total Cost`), `FY Total Cost  (Sub Projects)`, `FY Total Cost`)) %>%
group_by(`CFDA Code`, FY) %>%
summarize(total = sum(`FY Total Cost`)) %>%
ggplot(aes(FY, total)) +
geom_line() +
facet_wrap(~ `CFDA Code`, scales = "free_y")
# By total funding
xl %>%
mutate(`FY Total Cost` = if_else(is.na(`FY Total Cost`), `FY Total Cost  (Sub Projects)`, `FY Total Cost`)) %>%
group_by(`CFDA Code`, FY) %>%
summarize(total = sum(`FY Total Cost`)) %>%
ggplot(aes(FY, total)) +
geom_line() +
facet_wrap(~ `CFDA Code`)
str(xl)
# By total funding
xl %>%
filter(grepl("47", `CFDA Code`)) %>%
mutate(`FY Total Cost` = if_else(is.na(`FY Total Cost`), `FY Total Cost  (Sub Projects)`, `FY Total Cost`)) %>%
group_by(`CFDA Code`, FY) %>%
summarize(total = sum(`FY Total Cost`)) %>%
ggplot(aes(FY, total)) +
geom_line() +
facet_wrap(~ `CFDA Code`)
# By total funding
xl %>%
filter(grepl("47", `CFDA Code`)) %>%
mutate(`FY Total Cost` = if_else(is.na(`FY Total Cost`), `FY Total Cost  (Sub Projects)`, `FY Total Cost`)) %>%
group_by(`CFDA Code`, FY) %>%
summarize(total = sum(`FY Total Cost`)) %>%
ggplot(aes(FY, total)) +
geom_line() +
facet_wrap(~ `CFDA Code`, scales = "free_y")
# By number of projects
xl %>%
filter(grepl("47", `CFDA Code`)) %>%
count(`CFDA Code`, FY) %>%
ggplot(aes(FY, n)) +
geom_line() +
facet_wrap(~ `CFDA Code`, scales = "free_y")
View(xl)
xl %>% Mcount(FY)
xl %>% count(FY)
